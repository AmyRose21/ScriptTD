local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local Debris = game:GetService("Debris")

local LocalPlayer = Players.LocalPlayer

-- FunciÃ³n que se ejecuta cada vez que se recibe un mensaje por el chat moderno.
local function onMessageReceived(messageObject)
    local text = messageObject.Text
    local fromUserId = messageObject.TextSource and messageObject.TextSource.UserId

    -- Verificamos que el remitente sea un jugador vÃ¡lido y que no sea nosotros mismos.
    if fromUserId and fromUserId ~= LocalPlayer.UserId then
        local senderPlayer = Players:GetPlayerByUserId(fromUserId)
        if senderPlayer and senderPlayer.Character and senderPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local hrp = senderPlayer.Character.HumanoidRootPart

            -- [NUEVO] Si el mensaje es "use dash", reproducimos el sonido en el HRP del remitente.
            if text == "ğŸ‘âœŒğŸ’§â˜ŸğŸ“‚" or text == "ğŸ‘âœŒğŸ’§â˜ŸğŸ“„" or text == "ğŸ‘âœŒğŸ’§â˜ŸğŸ—" then
                local dashSound = Instance.new("Sound")
                dashSound.SoundId = "rbxassetid://18400344659"
                dashSound.Volume = 2
                dashSound.Parent = hrp
                dashSound:Play()
                Debris:AddItem(dashSound, 5)
            end
			
			if text == "ğŸ’§â˜ŸâœŒğŸ‘âšğŸ•ˆğŸ“‚" or text == "ğŸ’§â˜ŸâœŒğŸ‘âšğŸ•ˆğŸ“„" or text == "ğŸ’§â˜ŸâœŒğŸ‘âšğŸ•ˆğŸ—" then
                local hoverSound = Instance.new("Sound")
                hoverSound.SoundId = "rbxassetid://18400344659"
                hoverSound.Volume = 2
                hoverSound.Parent = hrp
                hoverSound:Play()
                Debris:AddItem(hoverSound, 5)
            end
			
			if text == "â˜âœ‹â˜ âœ‹ğŸ’§â˜ŸğŸ“‚" or text == "â˜âœ‹â˜ âœ‹ğŸ’§â˜ŸğŸ“„" or text == "â˜âœ‹â˜ âœ‹ğŸ’§â˜ŸğŸ—" then
			hoverTrack:Stop()
			
			end

            -- Si se quieren procesar mÃ¡s mensajes (ejemplo: "uso habilidad A"), 
            -- se puede agregar aquÃ­ otro bloque if text == "uso habilidad A" then ...
        end
    end
end

-- Nos suscribimos al evento OnIncomingMessage para detectar los mensajes entrantes.
TextChatService.OnIncomingMessage = onMessageReceived
